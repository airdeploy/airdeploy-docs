<!-- omit in toc -->

# Airdeploy Docs

- [Overview](#overview)
- [Branches](#branches)
- [Development Guide](#development-guide)
- [Contributing Content](#contributing-content)
  - [Adding New Sections](#adding-new-sections)
- [Deployment](#deployment)
  - [Version update](#version-update)
  - [Modifying the current version](#modifying-the-current-version)
  - [Modifying previous versions](#modifying-previous-versions)
  - [Publishing](#publishing)

## Overview

This is the Airdeploy Documentation website repo. It's built on [Docusaurus](https://docusaurus.io) framework.

## Branches

`master` branch is for the source files

`gh-pages` branch is the Github pages branch. This branch is autogenerated by deploy command and must not be touched manually. It consists of the static site assets (generated html, css, js, etc.).

## Development Guide

1. Install dependencies `yarn`
2. Start dev server to preview `yarn start`
3. There is a README.md file which describes on how to run docusaurus locally in the `website` directory generated by Docusaurus.

## Contributing Content

To contribute content, edit files in the `docs` directory. Docusaurus generates new versions of the documentation based on the content in this directory.

To manually modify previous versions of the documentation by editing the `website/versioned_docs/` directory.

### Adding New Sections

1. Create a file with .md extension and put it to the docs sub-folder you need. File header pattern:

   ```markdown
   ---
   id: filename_without_extesion
   title: title
   sidebar_label: sidebar_label
   ---
   ```

2. Update `website/sidebars.json` file with a reference to your new file.
3. Restart `yarn start` from `website` dir to verify your changes, because you change the structure. You don't need to restart server when you are just editing a file
4. Create a PR to a `master` branch with the desired changes and request a review

## Deployment

### Version update

Before publishing, make sure you update the version:

```sh
yarn run version x.x.x
# where "x.x.x" is desired **new** version
```

This generates a new version in `website/versioned_docs` folder

### Modifying the current version

Make sure you always make changes in `docs/` folder, not in `versioned_docs` folder. `docs` is the source and versioned is auto-generated files.

Let's say the current version is `1.0.0`.

It's not recommended changing the current version. Instead, it's usually better to increment the version. If you still want to do this you need to:

- Delete the current version from a folder `website/versioned_docs/version-1.0.0`
- Edit `website/versioned_sidebars/version-1.0.0-sidebars.json` and remove "1.0.0" from the array
- Generate the current version: `yarn run version 1.0.0`

### Modifying previous versions

It's not recommended, but if you need to make change in previous version:

- Open the directory with the version you want to change `website/versioned_docs/version-x.x.x`
- Make a change
- Make sure a change is reflected to all versions above

### Publishing

You must publish only `master` branch.

```sh
cd website

GIT_USER=<GIT_USER> \
  CURRENT_BRANCH=master \
  USE_SSH=true \
  yarn run publish-gh-pages
```

This command will build html,css,js and push it to the `gh-pages` branch

More info:
https://docusaurus.io/docs/en/publishing#using-github-pages
